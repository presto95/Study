# Operation Queues

코코아의 오퍼레이션은 비동기적으로 수행하기 원하는 작업을 캡슐화하는 객체 지향적 방법입니다. 오퍼레이션은 오퍼레이션 큐 또는 오퍼레이션 간 결합에서 사용되도록 설계되었습니다. Objective-C에 기반하기 때문에, 오퍼레이션은 macOS와 iOS에서 코코아 기반 애플리케이션에서 가장 흔하게 사용됩니다.

이 챕터는 오퍼레이션을 정의하고 사용하는 방법에 대해 보여줍니다.

## 오퍼레이션 오브젝트에 대하여

*오퍼레이션 오브젝트*는 Foundation 프레임워크에 있는 `NSOperation` 클래스의 인스턴스이며, 애플리케이션에서 수행하기 원하는 작업을 캡슐화할 때 사용합니다. `NSOperation` 클래스는 그 자체가 추상화된 기반 클래스이기 때문에 어떤 유용한 작업을 하기 위해서는 서브클래싱 되어야 합니다. 추상화되었다 할지라도, 이 클래스는 당신이 서브클래스에서 해야 하는 작업량을 최소화하기 위해 상당한 양의 인프라를 제공합니다. 게다가, Foundation 프레임워크는 두 개의 구체적인 서브클래스를 제공하며, 존재하는 코드에서 있는 그대로 사용할 수 있습니다.

| 클래스                | 설명                                                         |
| --------------------- | ------------------------------------------------------------ |
| NSInvocationOperation | 애플리케이션에서 어떠한 오브젝트와 셀렉터에 기반하여 오퍼레이션 오브젝트를 있는 그대로 생성하기 위해 사용하는 클래스. 필요한 작업을 이미 수행하고 있는 존재하는 메소드를 가지고 있는 경우에 이 클래스를 사용할 수 있습니다. 서브클래싱을 요구하지 않기 때문에, 이 클래스를 사용하여 더욱 동적인 방식으로 오퍼레이션 오브젝트를 생성할 수도 있습니다.<br/>Creating an NSInvocationOperation Object에서 이 클래스를 사용하는 방법에 대한 정보를 확인할 수 있습니다. |
| NSBlockOperation      | 하나 또는 그 이상의 블록 오브젝트를 병렬적으로 실행하기 위해 있는 그대로 사용하는 클래스. 하나 이상의 블록을 실행할 수 있기 때문에, 블록 오퍼레이션 오브젝트는 그룹 의미론을 사용하여  동작합니다. 이는 모든 연관된 블록의 실행이 종료되어야 그 자체가 종료된 것으로 간주된다는 것을 의미합니다.<br/>Creating an NSBlockOperation Object에서 이 클래스를 사용하는 방법에 대한 정보를 확인할 수 있습니다. 블록에 대해서는 Blocks Programming Topics를 참고하십시오. |
| NSOperation           | 커스텀 오퍼레이션 오브젝트를 정의하기 위한 기반 클래스. `NSOperation`을 서브클래싱하여 당신 자신의 오퍼레이션 구현에 완전한 통제를 할 수 있으며, 당신의 오퍼레이션이 실행하고 그 상태를 보고하는 기본 방법을 바꾸는 능력을 포함합니다.<br/>Defining a Custom Operation Object에서 커스텀 오퍼레이션 오브젝트를 정의하는 방법에 대한 정보를 확인할 수 있습니다. |

모든 오퍼레이션 오브젝트는 다음의 주요 특징을 지원합니다.

- 오퍼레이션 오브젝트 간 그래프 기반 의존성 확립을 지원합니다. 이러한 의존성들은 의존하는 모든 작업의 실행이 완료될 때까지 주어진 작업이 실행되는 것을 방지합니다. Configuring Interoperation Dependencies를 참고하십시오.
- 선택적인 컴플리션 블록을 지원합니다. 이는 오퍼레이션의 주요 작업이 완료된 후 실행됩니다. Setting Up a Completion Block을 참고하십시오.
- KVO 알림을 사용하여 오퍼레이션의 실행 상태 변화를 모니터링하는 것을 지원합니다. Key-Value Observing Programming Guide를 참고하십시오.
- 오퍼레이션의 우선 순위 지정을 지원하며 상대적인 실행 순서에 영향을 줍니다. Changing an Operation's Execution Priority를 참고하십시오.
- 실행 중일 때 오퍼레이션을 중지하는 것을 허락하는, 의미적 취소를 지원합니다. Canceling Operations에서 오퍼레이션을 취소하는 방법, Responding to Cancellation Events에서 커스텀 오퍼레이션에서 취소를 지원하는 방법을 알아보십시오.

오퍼레이션은 애플리케이션에서 동시성의 수준을 향상시키는 것을 돕기 위해 설계되었습니다. 오퍼레이션은 또한 간단한 개별 묶음으로 애플리케이션의 행동을 조직하고 캡슐화하는 좋은 방법입니다. 애플리케이션의 메인 쓰레드에서 코드를 실행시키는 대신, 하나 또는 그 이상의 오퍼레이션 오브젝트를 큐에 제출할 수 있고, 이에 상응하는 작업이 하나 또는 그 이상의 개별 쓰레드에서 비동기적으로 수행되게 할 수 있습니다.

## 동시 vs. 비(非)동시 오퍼레이션

일반적으로 오퍼레이션 큐에 오퍼레이션을 추가하여 그것을 실행한다 할지라도, 필수적으로 그렇게 해야 하는 것은 아닙니다. 오퍼레이션의 `start` 메소드를 호출하여 오퍼레이션 오브젝트를 수동으로 실행하는 것도 가능하나, 이렇게 하는 것은 나머지 코드와 함께 그 오퍼레이션이 동시적으로 동작할 것이라는 것을 보장하지 않습니다. `NSOperation` 클래스의 `isConcurrent` 메소드는 `start` 메소드를 호출한 쓰레드의 관점에서 어떠한 오퍼레이션이 동기적인지 비동기적인지에 대해 알려줍니다. 기본적으로, 이 메소드는 `false`를 반환하며, 이는 호출 쓰레드에서 동기적으로 해당 오퍼레이션이 동작하고 있다는 것을 의미합니다.

*동시 작업*을 구현하기 원한다면, 즉, 호출 쓰레드의 관점에서 비동기적으로 오퍼레이션이 동작하기 원한다면, 오퍼레이션을 비동기적으로 시작하게 하기 위해 추가 코드를 작성해야 합니다. 예를 들어, 별도의 쓰레드를 생성하거나, 비동기적인 시스템 함수를 호출하거나, `start` 메소드가 작업을 시작하고 작업이 완료되기 전에 즉시 반환하게 할 수 있습니다.

대부분의 개발자들은 동시적인 오퍼레이션 오브젝트를 구현할 필요가 없습니다. 항상 오퍼레이션 큐에 당신의 오퍼레이션을 추가한다면, 동시 오퍼레이션을 구현할 필요가 없습니다. 동시적이지 않은 오퍼레이션을 오퍼레이션 큐에 제출할 때, 큐 자체적으로 그 오퍼레이션이 동작할 쓰레드를 생성합니다. 그러므로, 동시적이지 않은 오퍼레이션을 오퍼레이션 큐에 추가하는 것은 여전히 당신의 오퍼레이션 오브젝트 코드의 비동기적 실행의 결과를 가져옵니다. 동시 오퍼레이션을 정의하는 능력은 오퍼레이션 큐에 작업을 추가하지 않고 그것을 비동기적으로 실행할 필요가 있는 경우에만 필수적입니다.

동시 오퍼레이션을 생성하는 방법을 Configuring Operations for Concurrent Execution 및 NSOperation Class Reference에서 확인하십시오.

## NSInvocationOperation 오브젝트 생성하기

